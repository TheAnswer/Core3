/*
 * EndVulnerabilityTask.h
 *
 *  Created on: Oct 27, 2012
 *      Author: root
 */

#ifndef ENDVULNERABILITYTASK_H_
#define ENDVULNERABILITYTASK_H_


#include "engine/engine.h"
#include "server/zone/managers/gcw/GCWManager.h"
#include "server/zone/objects/building/components/DestructibleBuildingDataComponent.h"

class EndVulnerabilityTask : public Task {
	ManagedWeakReference<BuildingObject*> buildingObject;
	ManagedWeakReference<GCWManager*> gcwManager;
public:
	EndVulnerabilityTask(GCWManager* gcwMan, BuildingObject* building) {
		gcwManager = gcwMan;
		buildingObject = building;
	}

	void run() {
		ManagedReference<GCWManager*> strongRefManager = gcwManager.get();
		ManagedReference<BuildingObject*> strongRefBuilding = buildingObject.get();
		if (strongRefBuilding == NULL || strongRefManager == NULL  )
			return;

		strongRefManager->endVulnerability(strongRefBuilding);
	}
};



#endif /* ENDVULNERABILITYTASK_H_ */
